lat = as.numeric(as.character(Y))/1000000,
popups1 = sprintf("<p>%s</p><p>%s</p><p>%s</p>",POIName, Telno, Address),
popups2 = sprintf("<p>%s</p><p>%s</p>",POIID, Telno)
)
stores711inTP <- storesInTPMap[, -c(2:3)]
# Write.csv
utf8File <- file('C:/NTUTrainRL2/data/stores711inTP.csv', encoding="utf8")
write.csv(stores711inTP, file=utf8File, row.names=F)
stores <- read.table("C:/NTUTrainRL2/data/stores711inTP.csv", header=T, sep=",", stringsAsFactors=F, encoding = "UTF-8")
markers711 <- leaflet(data=stores) %>%
addTiles() %>%
addMarkers(~lng, ~lat, popup=~popups2)
markers711
stores <- read.table("C:/NTUTrainRL2/data/stores711inTP.csv", header=T, sep=",", stringsAsFactors=F, encoding = "UTF-8")
stores <- read.table("C:/NTUTrainRL2/data/stores711inTP.csv", header=T, sep=",", stringsAsFactors=F, encoding = "UTF-8")
storesInTPMap <- storesInTP[, c("POIID", "X", "Y", "POIName", "Telno", "Address")]
storesInTPMap <- transform(
storesInTPMap,
lng = as.numeric(as.character(X))/1000000,
lat = as.numeric(as.character(Y))/1000000,
popups1 = sprintf("<p>%s</p><p>%s</p><p>%s</p>",POIName, Telno, Address),
popups2 = sprintf("<p>%s</p><p>%s</p>",POIID, Telno)
)
stores711inTP <- storesInTPMap[, -c(1:6)]
# Write.csv
utf8File <- file('C:/NTUTrainRL2/data/stores711inTP.csv', encoding="utf8")
write.csv(stores711inTP, file=utf8File, row.names=F)
stores <- read.table("C:/NTUTrainRL2/data/stores711inTP.csv", header=T, sep=",", stringsAsFactors=F, encoding = "UTF-8")
markers711 <- leaflet(data=stores) %>%
addTiles() %>%
addMarkers(~lng, ~lat, popup=~popups2)
markers711
q()
sapply(packs, library, character.only=T)
packs <- c("leaflet", "magrittr")
sapply(packs, library, character.only=T)
stores <- read.table("C:/NTUTrainRL2/data/stores711inTP.csv", header=T, sep=",", stringsAsFactors=F, encoding = "UTF-8")
markers711 <- leaflet(data=stores) %>%
addTiles() %>%
addMarkers(~lng, ~lat, popup=~as.character(popups1), icon = list(iconUrl = "C:/NTUTrainRL2/image/711_logo.gif", iconSize = c(20, 20))))
markers711
markers711 <- leaflet(data=stores) %>%
addTiles() %>%
addMarkers(~lng, ~lat, popup=~as.character(popups1), icon = list(iconUrl = "C:/NTUTrainRL2/image/711_logo.gif", iconSize = c(20, 20)))
markers711
markers711 <- leaflet(data=stores) %>%
addTiles() %>%
addMarkers(~lng, ~lat, popup=~as.character(popups2), icon = list(iconUrl = "C:/NTUTrainRL2/image/711_logo.gif", iconSize = c(20, 20)))
markers711
markers711 <- leaflet(data=stores) %>%
addTiles() %>%
addMarkers(~lng, ~lat, popup=~as.character(popups2), icon = list(iconUrl = "C:/NTUTrainRL2/image/711_logo.gif", iconSize = c(20, 20)), clusterOptions = markerClusterOptions())
markers711
cities <- read.csv(textConnection("
city,lat,lng,pop
New Taipei,25.016028,121.462062,3966818
Taipei,25.033141,121.559886,2702315
Taichung,24.149360,120.669673,2719835
Tainan,22.998952,120.226100,1884284
Kaohsiung,22.626788,120.312617,2778992
"))
circleOnMap <- leaflet(cities) %>%
addTiles() %>%
addCircles(lng = ~lng, lat = ~lat, weight = 1, radius = ~sqrt(pop) * 30, popup = ~city)
circleOnMap
circleOnMap <- leaflet(cities) %>%
addTiles() %>%
addCircles(lng = ~lng, lat = ~lat, weight = 1, radius = ~sqrt(pop) * 10, popup = ~city)
circleOnMap
circleOnMap <- leaflet(cities) %>%
addTiles() %>%
addCircles(lng = ~lng, lat = ~lat, weight = 1, radius = ~sqrt(pop) * 20, popup = ~city)
circleOnMap
circleOnMap <- leaflet(cities) %>%
setView(lng = 121.081340, lat = 23.905183, zoom = 8) %>%
addTiles() %>%
addCircles(lng = ~lng, lat = ~lat, weight = 1, radius = ~sqrt(pop) * 20, popup = ~city)
circleOnMap
circleOnMap <- leaflet(cities) %>%
setView(lng = 121.081340, lat = 23.905183, zoom = 6) %>%
addTiles() %>%
addCircles(lng = ~lng, lat = ~lat, weight = 1, radius = ~sqrt(pop) * 20, popup = ~city)
circleOnMap
circleOnMap <- leaflet(cities) %>%
setView(lng = 121.081340, lat = 23.905183, zoom = 7) %>%
addTiles() %>%
addCircles(lng = ~lng, lat = ~lat, weight = 1, radius = ~sqrt(pop) * 20, popup = ~city)
circleOnMap
circleOnMap <- leaflet(cities) %>%
setView(lng = 121.081340, lat = 23.905183, zoom = 6.5) %>%
addTiles() %>%
addCircles(lng = ~lng, lat = ~lat, weight = 1, radius = ~sqrt(pop) * 20, popup = ~city)
circleOnMap
circleOnMap <- leaflet(cities) %>%
setView(lng = 121.081340, lat = 23.905183, zoom = 6) %>%
addTiles() %>%
addCircles(lng = ~lng, lat = ~lat, weight = 1, radius = ~sqrt(pop) * 20, popup = ~city)
circleOnMap
circleOnMap <- leaflet(cities) %>%
setView(lng = 121.081340, lat = 23.905183, zoom = 6) %>%
addTiles() %>%
addCircles(lng = ~lng, lat = ~lat, weight = 1, radius = ~sqrt(pop) * 30, popup = ~sprintf("%s</br>%s",city,pop))
circleOnMap
circleOnMap <- leaflet(cities) %>%
setView(lng = 121.081340, lat = 23.905183, zoom = 6) %>%
addTiles() %>%
addCircles(lng = ~lng, lat = ~lat, weight = 1, radius = ~sqrt(pop) * 30, popup = ~sprintf("%s</br>%s ppl",city,pop))
circleOnMap
rectangleOnMap <- leaflet() %>%
addTiles() %>%
addRectangles(
lng1=121.531157, lat1=25.023037,
lng2=121.549696, lat2=25.009348,,
fillColor = "transparent")
rectangleOnMap
rectangleOnMap <- leaflet() %>%
addTiles() %>%
addRectangles(
lng1=121.531157, lat1=25.023037,
lng2=121.548581, lat2=25.009853,
fillColor = "transparent")
rectangleOnMap
rectangleOnMap <- leaflet() %>%
addTiles() %>%
addRectangles(
lng1=121.531157, lat1=25.023037,
lng2=121.545748, lat2=25.012381,
fillColor = "transparent")
rectangleOnMap
q()
packs <- c("leaflet", "magrittr")
sapply(packs, library, character.only=T)
topoData <- readLines("C:/NTUTrainRL2/data/twTown1982.topo.json") %>%
paste(collapse = "\n")
leaflet() %>%
setView(lng = 121.081340, lat = 23.905183, zoom = 6) %>%
addTiles() %>%
addTopoJSON(topoData, weight = 1, color = "#444444", fill = FALSE)
topoData <- readLines("C:/NTUTrainRL2/data/twTown1982.topo.json") %>%
paste(collapse = "\n")
leaflet() %>%
setView(lng = 121.081340, lat = 23.905183, zoom = 7) %>%
addProviderTiles('Stamen.TonerLite') %>%
addTopoJSON(topoData, weight = 2, color = "#444444", fill = FALSE)
leaflet() %>%
setView(lng = 121.081340, lat = 23.905183, zoom = 6) %>%
addProviderTiles('Stamen.TonerLite') %>%
addTopoJSON(topoData, weight = 2, color = "#444444", fill = FALSE)
leaflet() %>%
setView(lng = 121.081340, lat = 23.905183, zoom = 6) %>%
addProviderTiles('Stamen.TonerLite') %>%
addTopoJSON(topoData, weight = 2, color = "#444444", fill = T)
leaflet() %>%
setView(lng = 121.081340, lat = 23.905183, zoom = 6) %>%
addTiles() %>%
addTopoJSON(topoData, weight = 3, color = "#444444", fill = FALSE)
leaflet() %>%
setView(lng = 121.081340, lat = 23.905183, zoom = 6) %>%
addTiles() %>%
addTopoJSON(topoData, weight = 2, color = "#444444", fill = FALSE)
q()
usCrudeOilFromNorway <- c(96, 110, 103, 127, 60, 54, 43, 36, 20, 11, 22)
driverKilledInCollisionWithRailwayTrain <- c(76, 74, 76, 87, 66, 59, 63, 60, 55, 52, 46)
par(mfrow=c(2,1))
plot(driverKilledInCollisionWithRailwayTrain~usCrudeOilFromNorway)
plot(driverKilledInCollisionWithRailwayTrain~usCrudeOilFromNorway, xlim=c(0,150), ylim=c(0,100))
par(mfrow=c(2,1))
plot(driverKilledInCollisionWithRailwayTrain~usCrudeOilFromNorway)
plot(driverKilledInCollisionWithRailwayTrain~usCrudeOilFromNorway, xlim=c(0,150), ylim=c(0,100))
par(mfrow=c(2,1))
plot(driverKilledInCollisionWithRailwayTrain~usCrudeOilFromNorway)
plot(driverKilledInCollisionWithRailwayTrain~usCrudeOilFromNorway, xlim=c(0,150), ylim=c(0,100))
par(mfrow=c(1,2))
plot(driverKilledInCollisionWithRailwayTrain~usCrudeOilFromNorway)
plot(driverKilledInCollisionWithRailwayTrain~usCrudeOilFromNorway, xlim=c(0,150), ylim=c(0,100))
year <- c(5, 6,	7, 8,	1,	2,	3,	4,	5,	6,	7,	8,	1,	2,	3,	4,	5,	6,	7)
salaryReal <- c(42520, 44195, 44798, 46040, 46605, 46716, 46330, 47058, 46989, 46447, 46521, 46650, 45038, 43193, 44989, 45508, 44726, 44446, 45494)
nthyear <- c(5, 6,	7, 8,	1,	2,	3,	4,	5,	6,	7,	8,	1,	2,	3,	4,	5,	6,	7)
salaryReal <- c(42520, 44195, 44798, 46040, 46605, 46716, 46330, 47058, 46989, 46447, 46521, 46650, 45038, 43193, 44989, 45508, 44726, 44446, 45494)
nthyear <- c(5, 6,	7, 8,	1,	2,	3,	4,	5,	6,	7,	8,	1,	2,	3,	4,	5,	6,	7)
salaryReal <- c(42520, 44195, 44798, 46040, 46605, 46716, 46330, 47058, 46989, 46447, 46521, 46650, 45038, 43193, 44989, 45508, 44726, 44446, 45494)
presidents <- c("李登輝", "李登輝", "李登輝", "李登輝", "陳水扁", "陳水扁", "陳水扁", "陳水扁", "陳水扁", "陳水扁", "陳水扁", "陳水扁", "馬英九", "馬英九", "馬英九", "馬英九", "馬英九", "馬英九", "馬英九")
Sys.setlocale(category = "LC_ALL", locale = "cht")
nthyear <- c(5, 6,	7, 8,	1,	2,	3,	4,	5,	6,	7,	8,	1,	2,	3,	4,	5,	6,	7)
salaryReal <- c(42520, 44195, 44798, 46040, 46605, 46716, 46330, 47058, 46989, 46447, 46521, 46650, 45038, 43193, 44989, 45508, 44726, 44446, 45494)
presidents <- c("李登輝", "李登輝", "李登輝", "李登輝", "陳水扁", "陳水扁", "陳水扁", "陳水扁", "陳水扁", "陳水扁", "陳水扁", "陳水扁", "馬英九", "馬英九", "馬英九", "馬英九", "馬英九", "馬英九", "馬英九")
lineDataFrame <- as.data.frame(nthyear, salaryReal, presidents)
lineDataFrame <- data.frame(nthyear, salaryReal, presidents)
View(lineDataFrame)
View(lineDataFrame)
attach(lineDataFrame)
plot(salaryReal~nthyear)
detach(lineDataFrame)
par(mfrow=(1,1))
par(mfrow=c(1,1))
attach(lineDataFrame)
plot(salaryReal~nthyear)
detach(lineDataFrame)
attach(lineDataFrame)
plot(salaryReal~nthyear, type="l")
detach(lineDataFrame)
library(reshape2)
lineDataFrameCast <- dcast(lineDataFrame, salaryReal~presidents+nthyear)
View(lineDataFrameCast)
lineDataFrameCast <- dcast(lineDataFrame, presidents~nthyear)
lineDataFrameCast <- dcast(lineDataFrame, nthyear~residents)
lineDataFrameCast <- dcast(lineDataFrame, nthyear~presidents)
View(lineDataFrameCast)
lineDataFrameCast <- dcast(lineDataFrame, nthyear~presidents+salaryReal)
View(lineDataFrameCast)
lineDataFrameCast <- dcast(lineDataFrame, salaryReal+nthyear~presidents)
View(lineDataFrameCast)
lineDataFrameCast <- dcast(lineDataFrame, nthyear~presidents)
View(lineDataFrameCast)
lineDataFrameCast <- dcast(lineDataFrame, nthyear~salaryReal)
View(lineDataFrameCast)
lineDataFrameCast <- dcast(lineDataFrame, nthyear~presidents)
View(lineDataFrameCast)
lineDataFrameCast <- dcast(lineDataFrame, nthyear~presidents+salaryReal)
View(lineDataFrameCast)
lineDataFrameCast <- dcast(lineDataFrame, nthyear~alaryReal)
lineDataFrameCast <- dcast(lineDataFrame, nthyear~salaryReal)
View(lineDataFrameCast)
lineDataFrameCast <- dcast(lineDataFrame, nthyear+salaryReal~presidents)
View(lineDataFrameCast)
lineDataFrameCast <- dcast(lineDataFrame, nthyear~presidents+salaryReal)
View(lineDataFrameCast)
View(lineDataFrameCast)
lineDataFrameCast <- dcast(lineDataFrame, nthyear~salaryReal)
View(lineDataFrameCast)
lineDataFrameCast <- dcast(lineDataFrame, nthyear~presidents)
lineDataFrameCast <- dcast(lineDataFrame, nthyear~presidents, value.var = salaryReal)
lineDataFrameCast <- dcast(lineDataFrame, nthyear~presidents)
View(lineDataFrameCast)
lineDataFrameCast <- dcast(lineDataFrame, nthyear~presidents, value.var = nthyear)
lineDataFrameCast <- dcast(lineDataFrame, nthyear~presidents)
View(lineDataFrameCast)
lineDataFrameCast <- dcast(lineDataFrame, nthyear+presidents~salaryReal)
View(lineDataFrameCast)
lineDataFrameCast <- dcast(lineDataFrame, nthyear~presidents)
View(lineDataFrameCast)
lineDataFrameCast <- dcast(lineDataFrame, nthyear~presidents, value.var = "salaryReal")
View(lineDataFrameCast)
View(lineDataFrameCast)
attach(lineDataFrameCast)
plot(salaryReal~李登輝, type="l")
detach(lineDataFrameCast)
attach(lineDataFrameCast)
plot(salaryReal~"李登輝", type="l")
detach(lineDataFrameCast)
plot(lineDataFrameCast[, 2]~lineDataFrameCast[, 1], type="l", col="yellow")
plot(lineDataFrameCast[, 2]~lineDataFrameCast[, 1], type="l", col="brown")
plot(lineDataFrameCast[, 2]~lineDataFrameCast[, 1], type="l", col="goldenrod")
lines(lineDataFrameCast[, 3], type="l", col="blue")
lines(lineDataFrameCast[, 4], type="l", col="darkgreen")
lines(lineDataFrameCast[, 4], type="l", col="darkgreen")
plot(lineDataFrameCast[, 2]~lineDataFrameCast[, 1], type="l", col="goldenrod")
lines(lineDataFrameCast[, 3], type="l", col="blue")
lines(lineDataFrameCast[, 4], type="l", col="darkgreen")
View(lineDataFrameCast)
plot(lineDataFrameCast[, 2]~lineDataFrameCast[, 1], type="l", col="goldenrod")
lines(lineDataFrameCast[, 3]~lineDataFrameCast[, 1], type="l", col="blue")
lines(lineDataFrameCast[, 4]~lineDataFrameCast[, 1], type="l", col="darkgreen")
plot(lineDataFrameCast[, 2]~lineDataFrameCast[, 1], type="l", col="goldenrod")
lines(lineDataFrameCast[, 3]~lineDataFrameCast[, 1], type="l", col="blue")
lines(lineDataFrameCast[, 4]~lineDataFrameCast[, 1], type="l", col="darkgreen")
plot(lineDataFrameCast[, 2]~lineDataFrameCast[, 1], type="l", col="goldenrod", ylim=c(42500, 50000))
lines(lineDataFrameCast[, 3]~lineDataFrameCast[, 1], type="l", col="blue")
lines(lineDataFrameCast[, 4]~lineDataFrameCast[, 1], type="l", col="darkgreen")
plot(lineDataFrameCast[, 2]~lineDataFrameCast[, 1], type="l", col="goldenrod", ylim=c(42500, 48000))
lines(lineDataFrameCast[, 3], type="l", col="blue")
lines(lineDataFrameCast[, 4], type="l", col="darkgreen")
legend("bottomright", legend=c("李登輝","馬英九","陳水扁"), col=c("goldenrod","blue","darkgreen"), lty=1,lwd=2)
plot(lineDataFrameCast[, 2]~lineDataFrameCast[, 1], type="l", col="goldenrod", ylim=c(42500, 50000))
lines(lineDataFrameCast[, 3], type="l", col="blue")
lines(lineDataFrameCast[, 4], type="l", col="darkgreen")
legend("topright", legend=c("李登輝","馬英九","陳水扁"), col=c("goldenrod","blue","darkgreen"), lty=1,lwd=2)
legend("topright", legend=c("李登輝","馬英九","陳水扁"), col=c("goldenrod","blue","darkgreen"))
plot(lineDataFrameCast[, 2]~lineDataFrameCast[, 1], type="l", col="goldenrod", ylim=c(42500, 60000))
lines(lineDataFrameCast[, 3], type="l", col="blue")
lines(lineDataFrameCast[, 4], type="l", col="darkgreen")
legend("topright", legend=c("李登輝","馬英九","陳水扁"), col=c("goldenrod","blue","darkgreen"), lty=1,lwd=2)
plot(lineDataFrameCast[, 2]~lineDataFrameCast[, 1], type="l", col="goldenrod", ylim=c(42500, 50000))
lines(lineDataFrameCast[, 3], type="l", col="blue")
lines(lineDataFrameCast[, 4], type="l", col="darkgreen")
legend("top", legend=c("李登輝","馬英九","陳水扁"), ncol=3, cex=0.8, bty="n", col=c("goldenrod", "blue", "darkgreen"), lty=1, lwd=2)
plot(lineDataFrameCast[, 2]~lineDataFrameCast[, 1], type="l", col="goldenrod", ylim=c(42000, 48000))
lines(lineDataFrameCast[, 3], type="l", col="blue")
lines(lineDataFrameCast[, 4], type="l", col="darkgreen")
legend("top", legend=c("李登輝","馬英九","陳水扁"), ncol=3, cex=0.8, bty="n", col=c("goldenrod", "blue", "darkgreen"), lty=1, lwd=2)
plot(lineDataFrameCast[, 2]~lineDataFrameCast[, 1], type="l", col="goldenrod", ylim=c(42000, 50000), lwd=2)
lines(lineDataFrameCast[, 3], type="l", col="blue", lwd=2)
lines(lineDataFrameCast[, 4], type="l", col="darkgreen", lwd=2)
legend("top", legend=c("李登輝","馬英九","陳水扁"), ncol=3, cex=0.8, bty="n", col=c("goldenrod", "blue", "darkgreen"), lty=1, lwd=2)
plot(lineDataFrameCast[, 2]~lineDataFrameCast[, 1], type="l", col="goldenrod", ylim=c(42000, 50000), lwd=2)
lines(lineDataFrameCast[, 3], type="l", col="blue", lwd=2)
lines(lineDataFrameCast[, 4], type="l", col="darkgreen", lwd=2)
legend("topright", legend=c("李登輝","馬英九","陳水扁"), col=c("goldenrod", "blue", "darkgreen"), lty=1, lwd=2)
plot(lineDataFrameCast[, 2]~lineDataFrameCast[, 1], type="l", col="goldenrod", ylim=c(42000, 50000), lwd=2)
lines(lineDataFrameCast[, 3], type="l", col="blue", lwd=2)
lines(lineDataFrameCast[, 4], type="l", col="darkgreen", lwd=2)
#legend("topright", legend=c("李登輝","馬英九","陳水扁"), col=c("goldenrod", "blue", "darkgreen"), lty=1, lwd=2)
legend("top", legend=c("李登輝","馬英九","陳水扁"), ncol=3, cex=0.8, bty="n", col=c("goldenrod", "blue", "darkgreen"), lty=1, lwd=2)
par(mfrow=c(1,1))
plot(driverKilledInCollisionWithRailwayTrain~usCrudeOilFromNorway, col="red")
plot(driverKilledInCollisionWithRailwayTrain~usCrudeOilFromNorway, col="red" fill=T)
plot(driverKilledInCollisionWithRailwayTrain~usCrudeOilFromNorway, col="red", fill=T)
plot(driverKilledInCollisionWithRailwayTrain~usCrudeOilFromNorway, col="red")
par(mfrow=c(1,1))
plot(driverKilledInCollisionWithRailwayTrain~usCrudeOilFromNorway, col="red")
par(bg="grey")
plot(driverKilledInCollisionWithRailwayTrain~usCrudeOilFromNorway)
plot(rnorm(100),
main="Plot Title",
col.axis="blue",
col.lab="red",
col.main="darkblue")
par(bg="white")
par(bg="white")
plot(rnorm(100),
main="Plot Title",
col.axis="blue",
col.lab="red",
col.main="darkblue")
q()
install.packages("ggplot2")
library(ggplot2)
setwd("C:/NTUTrainRL2")
Sys.setlocale(category = "LC_ALL", locale = "cht")
accidentList <- readRDS('data/accidentList.rds')
colnames(accidentList) <- c("醫院所在縣市別", "醫院別", "性別", "國籍別", "年齡", "醫療檢傷", "救護檢傷")
summary(accidentList)#看到一筆101歲的極端值，好像不太對
accidentListNew <- subset(accidentList, 年齡!=101 | is.na(年齡))#使用一下subset()函數!
ggplot(accidentListNew, aes(x=醫院所在縣市別)) + geom_bar(fill="lightblue", colour="black")+ylab("人數")+ggtitle("依醫院所在縣市別")
p1 <- ggplot(accidentListNew, aes(x=醫院所在縣市別)) + geom_bar(fill="lightblue", colour="black")+ylab("人數")+ggtitle("依醫院所在縣市別")
str(p1)
p1
p2 <- ggplot(accidentListNew, aes(x=性別)) + geom_bar(fill="lightblue", colour="black")+ylab("人數")+ggtitle("依性別")
p3 <- ggplot(accidentListNew, aes(x=國籍別)) + geom_bar(fill="lightblue", colour="black")+ylab("人數")+ggtitle("依國籍別")
p4 <- ggplot(accidentListNew, aes(x=醫療檢傷)) + geom_bar(fill="lightblue", colour="black")+ylab("人數")+ggtitle("依醫療檢傷別")
p5 <- ggplot(accidentListNew, aes(x=救護檢傷)) + geom_bar(fill="lightblue", colour="black")+ylab("人數")+ggtitle("依救護檢傷別")
p6 <- ggplot(accidentListNew, aes(x=醫院別)) + geom_bar(fill="lightblue", colour="black")+ylab("人數")+ggtitle("依醫院別")+theme(axis.text.x = element_text(angle = 90, hjust = 1))
library(gridExtra)
grid.arrange(p1, p2, p3, p4, p5, p6, ncol = 2)
?ggplot
?install.packages
ggplot(accidentListNew, aes(x=年齡))+geom_histogram(binwidth=3, fill="lightblue", colour="black")+ggtitle("八仙傷亡年齡直方圖")+ylab("頻率")
summary(accidentListNew$年齡)
summary(accidentListNew[, "年齡"])
summary(accidentListNew[, 5])
p1 <- ggplot(accidentListNew, aes(x=醫院所在縣市別, y=年齡)) + geom_boxplot()+ggtitle("年齡依醫院所在縣市別")
p1
p2 <- ggplot(accidentListNew, aes(x=性別, y=年齡)) + geom_boxplot()+ggtitle("年齡依性別")
p3 <- ggplot(accidentListNew, aes(x=國籍別, y=年齡)) + geom_boxplot()+ggtitle("年齡依國籍別")
p4 <- ggplot(accidentListNew, aes(x=醫療檢傷, y=年齡)) + geom_boxplot()+ggtitle("年齡依醫療檢傷別")
p5 <- ggplot(accidentListNew, aes(x=救護檢傷, y=年齡)) + geom_boxplot()+ggtitle("年齡依救護檢傷別")
grid.arrange(p1, p2, p3, p4, p5, ncol = 2)
accidentListShort <- accidentListNew[accidentListNew$醫院所在縣市別=='桃園市' & !is.na(accidentListNew$年齡), ]
accidentListShortOrder <- accidentListShort[order(accidentListShort$年齡), ]
ggplot(accidentListShortOrder, aes(x = 年齡, y=reorder(row.names(accidentListShortOrder), 年齡))) + geom_point(size=3)+ylab("編號")+ggtitle("點圖依年齡")
slices <- as.vector(table(accidentListNew$醫療檢傷))#把table轉為向量
slices
labels <- names(table(accidentListNew$醫療檢傷))
labels
percentage <- round(slices/sum(slices), 3)
percentage
ymax <- cumsum(percentage)
ymin <- c(0, head(ymax, n=-1))
donutData <- data.frame(labels, percentage, ymax, ymin)
View(donutData)
donutData
ggplot(donutData) + geom_rect(aes(fill=labels, ymax=ymax, ymin=ymin, xmax=4, xmin=3)) + coord_polar(theta="y") + xlim(c(0, 4))
usCrudeOilFromNorway <- c(96, 110, 103, 127, 60, 54, 43, 36, 20, 11, 22)
driverKilledInCollisionWithRailwayTrain <- c(76, 74, 76, 87, 66, 59, 63, 60, 55, 52, 46)
scatterPlotData <- data.frame(usCrudeOilFromNorway, driverKilledInCollisionWithRailwayTrain)
scatterPlot <- ggplot(scatterPlotData, aes(x=usCrudeOilFromNorway, y=driverKilledInCollisionWithRailwayTrain)) + geom_point(size=4)
scatterPlot
scatterPlot <- ggplot(scatterPlotData, aes(x=usCrudeOilFromNorway, y=driverKilledInCollisionWithRailwayTrain)) + geom_point(size=4)+ylab("Driver Killed in Collision With Railway Train(in people per year)")+xlab("US Crude Oil Imported From Norway(in million barrels per year)")+ggtitle("High correlation but no causality")
scatterPlot
scatterPlot+stat_smooth(method=lm, level=0.99)
scatterPlot+annotate("text", label=paste("Correlation=",correlation), x=85, y=60)
correlation <- round(cor(usCrudeOilFromNorway, driverKilledInCollisionWithRailwayTrain), 4)*100
scatterPlot+annotate("text", label=paste("Correlation=",correlation), x=85, y=60)
scatterPlot+stat_smooth(method=lm, level=0.99)+annotate("text", label=paste("Correlation=",correlation), x=85, y=60)
year <- c(1996, 1997,	1998,	1999,	2000,	2001,	2002,	2003,	2004,	2005,	2006,	2007,	2008,	2009,	2010,	2011,	2012,	2013,	2014)
salaryReal <- c(42520, 44195, 44798, 46040, 46605, 46716, 46330, 47058, 46989, 46447, 46521, 46650, 45038, 43193, 44989, 45508, 44726, 44446, 45494)
lineGraphData <- data.frame(year, salaryReal)
ggplot(lineGraphData, aes(x=year, y=salaryReal)) + geom_line() + geom_point(size=4)+ggtitle("歷年工業及服務業受僱員工以100年價格衡量之實質薪資")+xlab("")+ylab("")
nthyear <- c(5, 6,  7, 8,	1,	2,	3,	4,	5,	6,	7,	8,	1,	2,	3,	4,	5,	6,	7)
presidents <- c("李登輝", "李登輝", "李登輝", "李登輝", "陳水扁", "陳水扁", "陳水扁", "陳水扁", "陳水扁", "陳水扁", "陳水扁", "陳水扁", "馬英九", "馬英九", "馬英九", "馬英九", "馬英九", "馬英九", "馬英九")
lineGraphData <- data.frame(nthyear, salaryReal, presidents)
ggplot(lineGraphData, aes(x=nthyear, y=salaryReal, colour=presidents))+geom_line(lwd=2)+geom_point(size=4)#automatically assign colors
ggplot(lineGraphData, aes(x=nthyear, y=salaryReal, colour=presidents))+geom_line(lwd=2)+geom_point(size=4)+scale_colour_manual(values = c("李登輝" = "goldenrod", "陳水扁" = "darkgreen", "馬英九" = "blue"))#custom colors
ggplot(accidentListNew, aes(x=醫院所在縣市別, y=年齡)) + geom_boxplot()
ggplot(accidentListNew, aes(x=醫院所在縣市別, y=年齡)) + geom_boxplot()+ggtitle("年齡依醫院所在縣市別")+coord_flip()
ggplot(accidentListNew, aes(x=醫院所在縣市別, y=年齡)) + geom_boxplot()+ggtitle("年齡依醫院所在縣市別")
ggplot(accidentListNew, aes(x=醫院所在縣市別, y=年齡)) + geom_boxplot()+ggtitle("年齡依醫院所在縣市別")+ylim(0, 50)
ggplot(accidentListNew, aes(x=醫院所在縣市別, y=年齡)) + geom_boxplot()+ggtitle("年齡依醫院所在縣市別")+theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank())
ggplot(accidentListNew, aes(x=醫院所在縣市別, y=年齡)) + geom_boxplot()+ggtitle("年齡依醫院所在縣市別")+theme_bw()
ggplot(accidentListNew, aes(x=醫院所在縣市別, y=年齡)) + geom_boxplot()+ggtitle("年齡依醫院所在縣市別")+theme_bw()+theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank())
ggplot(accidentListNew, aes(x=醫院所在縣市別, y=年齡, fill=醫院所在縣市別)) + geom_boxplot()+ggtitle("年齡依醫院所在縣市別")
ggplot(accidentListNew, aes(x=醫院所在縣市別, y=年齡, fill=醫院所在縣市別)) + geom_boxplot()+ggtitle("年齡依醫院所在縣市別")+guides(fill=FALSE)
ggplot(accidentListNew, aes(x=醫院所在縣市別, y=年齡, fill=醫院所在縣市別)) + geom_boxplot()+ggtitle("年齡依醫院所在縣市別")+theme(legend.position="top")
ggplot(accidentListNew, aes(x=性別)) + geom_bar(fill="lightblue", colour="black")+ylab("人數")+ggtitle("依性別")
ggplot(accidentListNew, aes(x=性別)) + geom_bar(fill="lightblue", colour="black")+ylab("人數")+ggtitle("依性別")+facet_grid(. ~醫療檢傷)#1*n
ggplot(accidentListNew, aes(x=性別)) + geom_bar(fill="lightblue", colour="black")+ylab("人數")+ggtitle("依性別")+facet_grid(醫療檢傷~.)#m*1
ggplot(accidentListNew, aes(x=性別)) + geom_bar(fill="lightblue", colour="black")+ylab("人數")+ggtitle("依性別")+facet_grid(醫療檢傷~救護檢傷)#m*n
ggplot(scatterPlotData, aes(x=usCrudeOilFromNorway, y=driverKilledInCollisionWithRailwayTrain)) + geom_point(colour="red", size=4)
ggplot(accidentListNew, aes(x=年齡))+geom_histogram(binwidth=3, fill="red", colour="black")+ggtitle("八仙傷亡年齡直方圖")+ylab("頻率")
dummyDF <- data.frame(xaxis=c(-5,5))#用來侷限X軸
ggplot(dummyDF, aes(x=xaxis))+stat_function(fun=dnorm)
customFunction <- function(xvar){
1/(1+exp(-xvar+10))
}
dummyDF <- data.frame(xaxis=c(0,20))#用來侷限X軸
ggplot(dummyDF, aes(x=xaxis))+stat_function(fun=customFunction)
presidentsRating <- readRDS('data/presidentsRating.rds')
head(presidentsRating)
tail(presidentsRating)
presidentsRating <- readRDS('data/presidentsRating.rds')
ggplot(presidentsRating, aes(x=year, y=quarter, fill=rating)) + geom_raster()#More efficient
ggplot(presidentsRating, aes(x=year, y=quarter, fill=rating)) + geom_raster() + scale_x_continuous(breaks=seq(1940, 1976, by=4)) + scale_y_reverse() + scale_fill_gradient2(midpoint=50, mid="grey70", limits=c(0,100))
library(vcd)
HairEyeColor
mosaic(HairEyeColor, shade=TRUE, legend=FALSE)#用一個table的示範資料集
str(presidents)
rm(presidents)
str(presidents)
presidentsRating <- data.frame(
rating = as.numeric(presidents),
year = as.numeric(floor(time(presidents))),
quarter = as.numeric(cycle(presidents))
)
str(presidentsRating)
presidents
packs <- c("leaflet", "magrittr")
sapply(packs, library, character.only=T)
head(accidentList)
accidentList %>% head
tail(head(accidentList, 10))
tail(head(accidentList, 10), 1)
accidentList % head(.,10) % tail(.,1)
accidentList %>% head(.,10) %>% tail(.,1)
helloMap <- leaflet()
helloMap
helloMap <- leaflet() %>%
addTiles()
helloMap
helloMap <- leaflet() %>%
addTiles() %>% #把預設的地圖圖層加入
addMarkers(lng=121.539366, lat=25.017326, popup="National Taiwan University")
helloMap
helloMap <- leaflet()
helloMap <- addTiles()
helloMap <- addMarkers(lng=121.539366, lat=25.017326, popup="National Taiwan University")
helloMap
helloMap <- leaflet()
helloMap <- addTiles(helloMap)
helloMap <- addMarkers(helloMap,lng=121.539366, lat=25.017326, popup="National Taiwan University")
helloMap
baseMap <- leaflet() %>%
setView(lng = 121.539366, lat = 25.017326, zoom = 14) %>%
addTiles()
baseMap
baseMap <- leaflet() %>%
setView(lng = 121.539366, lat = 25.017326, zoom = 6) %>%
addTiles()
baseMap
providerMap <- leaflet() %>%
setView(lng = 121.539366, lat = 25.017326, zoom = 10) %>%
addProviderTiles("Stamen.TonerLite")
providerMap
providerMap <- leaflet() %>%
setView(lng = 121.539366, lat = 25.017326, zoom = 10) %>%
addProviderTiles("Thunderforest.OpenCycleMap")
providerMap
combineMap <- leaflet() %>%
setView(lng = 121.539366, lat = 25.017326, zoom = 10) %>%
addProviderTiles("Stamen.TonerLite") %>%
addProviderTiles("Thunderforest.OpenCycleMap",
options = providerTileOptions(opacity = 0.5))
combineMap
combineMap <- leaflet() %>%
setView(lng = 121.539366, lat = 25.017326, zoom = 10) %>%
addProviderTiles("Stamen.TonerLite") %>%
addProviderTiles("Thunderforest.OpenCycleMap",
options = providerTileOptions(opacity = 0.3))
combineMap
markerNTU <- leaflet() %>%
addTiles() %>%
addMarkers(lng=121.539366, lat=25.017326, popup="National Taiwan University")
markerNTU
Sys.setlocale(category="LC_ALL", locale = "cht")
stores <- read.table("C:/NTUTrainRL2/data/stores711inTP.csv", header=T, sep=",", stringsAsFactors=F, encoding = "UTF-8")
head(stores)
view(stores)
View(stores)
markers711 <- leaflet(data=stores) %>%
addTiles() %>%
addMarkers(~lng, ~lat, popup=~as.character(popups2))
markers711
markers711 <- leaflet(data=stores) %>%
addTiles() %>%
addMarkers(~lng, ~lat, popup=~as.character(popups2), icon = list(iconUrl = "C:/NTUTrainRL2/image/711_logo.gif", iconSize = c(20, 20)))
markers711
markers711 <- leaflet(data=stores) %>%
addTiles() %>%
addMarkers(~lng, ~lat, popup=~as.character(popups2), icon = list(iconUrl = "C:/NTUTrainRL2/image/711_logo.gif", iconSize = c(20, 20)), clusterOptions = markerClusterOptions())
markers711
()
()
q()
